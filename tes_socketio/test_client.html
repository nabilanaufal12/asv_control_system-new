<!DOCTYPE html>
<html>
<head>
    <title>Tes Socket.IO (Perbaikan)</title>
    <style>
        body { font-family: monospace; }
        pre { background: #eee; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>Tes Simulasi Sederhana</h1>
    <p>Data yang diterima:</p>
    
    <pre id="data-display-box">Menunggu data...</pre>

    <script src="/socket.io/socket.io.js"></script>

    <script>
        // Tunggu sampai seluruh halaman HTML selesai dimuat
        document.addEventListener('DOMContentLoaded', () => {

            console.log("Halaman HTML (DOM) sudah dimuat. Menjalankan skrip.");
            
            // SEKARANG baru kita cari elemennya
            const displayElement = document.getElementById('data-display-box');

            // Jika elemen tidak ditemukan (karena salah ketik ID)
            if (!displayElement) {
                console.error("KRITIS: Tidak bisa menemukan elemen #data-display-box!");
                return;
            }

            console.log("Mencoba terhubung ke server...");
            const socket = io(); 

            socket.on('connect', () => {
                console.log('Berhasil terhubung ke server!');
                displayElement.textContent = "Terhubung! Menunggu data pertama...";
            });

            // Dengarkan event 'test_data'
            socket.on('test_data', (data) => {
                console.log('Menerima data:', data);
                
                // Tampilkan data di halaman
                displayElement.textContent = JSON.stringify(data, null, 2);
            });

            socket.on('disconnect', () => {
                console.warn('Terputus dari server.');
                displayElement.textContent = "TERPUTUS.";
            });
        });
    </script>
</body>
</html>